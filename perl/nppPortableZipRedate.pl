#!perl

use 5.014; # //, strict, say, s///r
use warnings;

my %dates = (
    "8.8.8"     => "20251108",
    "8.8.7"     => "20251020",
    "8.8.6"     => "20251007",
    "8.8.5"     => "20250813",
    "8.8.4"     => "20250812",
    "8.8.3"     => "20250709",
    "8.8.2"     => "20250630",
    "8.8.1"     => "20250504",
    "8.8"       => "20250428",
    "8.7.9"     => "20250402",
    "8.7.8"     => "20250307",
    "8.7.7"     => "20250207",
    "8.7.6"     => "20250127",
    "8.7.5"     => "20241224",
    "8.7.4"     => "20241204",
    "8.7.3"     => "20241130",
    "8.7.2"     => "20241127",
    "8.7.1"     => "20241104",
    "8.7"       => "20240907",
    "8.6.9"     => "20240714",
    "8.6.8"     => "20240604",
    "8.6.7"     => "20240513",
    "8.6.6"     => "20240510",
    "8.6.5"     => "20240330",
    "8.6.4"     => "20240220",
    "8.6.3"     => "20240218",
    "8.6.2"     => "20240114",
    "8.6.1"     => "20240105",
    "8.6"       => "20231123",
    "8.5.8"     => "20231017",
    "8.5.7"     => "20230907",
    "8.5.6"     => "20230815",
    "8.5.5"     => "20230809",
    "8.5.4"     => "20230618",
    "8.5.3"     => "20230515",
    "8.5.2"     => "20230406",
    "8.5.1"     => "20230324",
    "8.5"       => "20230306",
    "8.4.9"     => "20230131",
    "8.4.8"     => "20221225",
    "8.4.7"     => "20221108",
    "8.4.6"     => "20220929",
    "8.4.5"     => "20220907",
    "8.4.4"     => "20220715",
    "8.4.3"     => "20220708",
    "8.4.2"     => "20220603",
    "8.4.1"     => "20220511",
    "8.4"       => "20220426",
    "8.3.3"     => "20220315",
    "8.3.2"     => "20220227",
    "8.3.1"     => "20220215",
    "8.3"       => "20220203",
    "8.2.1"     => "20220124",
    "8.2"       => "20220101",
    "8.1.9.3"   => "20211208",
    "8.1.9.2"   => "20211121",
    "8.1.9.1"   => "20211113",
    "8.1.9"     => "20211022",
    "8.1.8"     => "20211019",
    "8.1.7"     => "20211015",
    "8.1.6"     => "20211013",
    "8.1.5"     => "20210927",
    "8.1.4"     => "20210825",
    "8.1.3"     => "20210813",
    "8.1.2"     => "20210719",
    "8.1.1"     => "20210704",
    "8.1"       => "20210617",
    "8.0"       => "20210607",

    "7.9.5"     => "20210323",
    "7.9.4"     => "20210315",
    "7.9.3"     => "20210215",
    "7.9.2"     => "20210101",
    "7.9.1"     => "20201102",
    "7.9"       => "20200928",
    "7.8.9"     => "20200716",
    "7.8.8"     => "20200628",
    "7.8.7"     => "20200608",
    "7.8.6"     => "20200420",
    "7.8.5"     => "20200306",
    "7.8.4"     => "20200130",
    "7.8.3"     => "20200116",
    "7.8.2"     => "20191205",
    "7.8.1"     => "20191029",
    "7.8"       => "20191011",
    "7.7.1"     => "20190620",
    "7.7"       => "20190519",
    "7.6.6"     => "20190404",
    "7.6.5"     => "20190331",
    "7.6.4"     => "20190306",
    "7.6.3"     => "20190127",
    "7.6.2"     => "20190101",
    "7.6.1"     => "20181212",
    "7.6"       => "20181112",
    "7.5.9"     => "20181014",
    "7.5.8"     => "20180723",
    "7.5.7"     => "20180630",
    "7.5.6"     => "20180318",
    "7.5.5"     => "20180227",
    "7.5.4"     => "20171231",
    "7.5.3"     => "20171205",
    "7.5.2"     => "20171127",
    "7.5.1"     => "20170829",
    "7.5"       => "20170815",
    "7.4.2"     => "20170618",
    "7.4.1"     => "20170618",
    "7.4"       => "20170514",
    "7.3.3"     => "20170308",
    "7.3.2"     => "20170213",
    "7.3.1"     => "20170117",
    "7.3"       => "20170101",
    "7.2.2"     => "20161127",
    "7.2.1"     => "20161120",
    "7.2"       => "20161102",
    "7.1"       => "20161016",
    "7.0"       => "20160921",

    "6.9.2"     => "20160518",
    "6.5"       => "20130928",
);

for my $zipfile (<*.zip>) {
    next unless $zipfile =~ /^npp\.(\d+(?:\.\d+)+)/;
    my $key = $1;
    my $timestamp = (exists $dates{$key}) ? $dates{$key} : undef;
    printf "%-20s %-20s %s\n", $key, $timestamp // '<undef>', $zipfile;
    if(defined $timestamp) {
        system("touch -t ${timestamp}1200 $zipfile");
    }
}
my ($s,$m,$h,$mday, $mon, $y1900) = (localtime)[0..5];
my $year = $y1900 + 1900;   # year started at 0 at 1900
$mon += 1;                  # January = 0
my $cmd = sprintf qq(touch -t %04d%02d%02d%02d%02d.%02d "%s"), $year, $mon, $mday, $h, $m, $s, $0;
system($cmd);
